<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>68Chat 静态配置管理</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .admin-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin: 2rem auto;
            max-width: 800px;
            padding: 2rem;
        }
        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e9ecef;
        }
        .config-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
        }
        .alert {
            border-radius: 10px;
            border: none;
        }
        .github-actions-info {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 1rem;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="admin-container">
            <div class="header">
                <h2><i class="bi bi-github text-primary"></i> GitHub Pages 配置管理</h2>
                <p class="text-muted">通过 GitHub Actions 管理网站配置</p>
            </div>

            <div class="alert alert-info" role="alert">
                <i class="bi bi-info-circle-fill"></i>
                <strong>注意</strong>: 这是静态版本的配置管理。配置更改需要通过 GitHub Actions 工作流进行。
            </div>

            <!-- 当前配置显示 -->
            <div class="config-section">
                <h5><i class="bi bi-gear"></i> 当前配置</h5>
                <div id="currentConfig">
                    <div class="row">
                        <div class="col-md-6">
                            <strong>网站标题:</strong>
                            <p id="currentTitle" class="text-muted">加载中...</p>
                        </div>
                        <div class="col-md-6">
                            <strong>联系邮箱:</strong>
                            <p id="currentEmail" class="text-muted">加载中...</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <strong>网站描述:</strong>
                            <p id="currentDescription" class="text-muted">加载中...</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <strong>Android下载:</strong>
                            <p id="currentAndroid" class="text-muted">加载中...</p>
                        </div>
                        <div class="col-md-6">
                            <strong>iOS下载:</strong>
                            <p id="currentiOS" class="text-muted">加载中...</p>
                        </div>
                    </div>
                    <small class="text-muted">
                        最后更新: <span id="lastModified">加载中...</span>
                    </small>
                </div>
            </div>

            <!-- GitHub Actions 配置更新 -->
            <div class="config-section">
                <h5><i class="bi bi-play-circle"></i> 更新配置</h5>
                <p class="text-muted">通过 GitHub Actions 工作流更新网站配置</p>
                
                <div class="mb-3">
                    <label class="form-label">网站标题</label>
                    <input type="text" class="form-control" id="newTitle" placeholder="输入新的网站标题">
                </div>
                
                <div class="mb-3">
                    <label class="form-label">网站描述</label>
                    <textarea class="form-control" id="newDescription" rows="3" placeholder="输入网站描述"></textarea>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Android下载链接</label>
                        <input type="url" class="form-control" id="newAndroid" placeholder="https://...">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">iOS下载链接</label>
                        <input type="url" class="form-control" id="newiOS" placeholder="https://...">
                    </div>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">联系邮箱</label>
                    <input type="email" class="form-control" id="newEmail" placeholder="admin@example.com">
                </div>
                
                <button class="btn btn-primary" onclick="generateWorkflowURL()">
                    <i class="bi bi-github"></i> 生成 GitHub Actions 链接
                </button>
            </div>

            <!-- GitHub Actions 信息 -->
            <div class="github-actions-info">
                <h6><i class="bi bi-lightbulb"></i> 如何使用 GitHub Actions 更新配置</h6>
                <ol>
                    <li>填写上方表单中的配置信息</li>
                    <li>点击"生成 GitHub Actions 链接"按钮</li>
                    <li>在新打开的 GitHub 页面中点击"Run workflow"</li>
                    <li>等待工作流执行完成，网站将自动更新</li>
                </ol>
                
                <div class="mt-3">
                    <strong>GitHub Actions 工作流地址:</strong><br>
                    <code id="workflowURL">https://github.com/YOUR_USERNAME/YOUR_REPO/actions/workflows/update-config.yml</code>
                    <button class="btn btn-sm btn-outline-primary ms-2" onclick="copyWorkflowURL()">
                        <i class="bi bi-copy"></i> 复制
                    </button>
                </div>
            </div>

            <!-- 手动配置方法 -->
            <div class="config-section">
                <h5><i class="bi bi-code-slash"></i> 手动配置方法</h5>
                <p class="text-muted">如果不使用 GitHub Actions，也可以直接编辑 data.json 文件</p>
                
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle-fill"></i>
                    <strong>手动步骤:</strong>
                    <ol class="mb-0 mt-2">
                        <li>在 GitHub 仓库中找到 <code>data.json</code> 文件</li>
                        <li>点击编辑按钮 (铅笔图标)</li>
                        <li>修改相应的配置值</li>
                        <li>提交更改，GitHub Pages 将自动更新</li>
                    </ol>
                </div>
            </div>

            <!-- 部署状态 -->
            <div class="config-section">
                <h5><i class="bi bi-cloud-check"></i> 部署状态</h5>
                <div class="row text-center">
                    <div class="col-md-4">
                        <div class="p-3">
                            <i class="bi bi-github display-6 text-primary"></i>
                            <h6 class="mt-2">GitHub Pages</h6>
                            <span class="badge bg-success">已启用</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="p-3">
                            <i class="bi bi-gear-fill display-6 text-info"></i>
                            <h6 class="mt-2">自动部署</h6>
                            <span class="badge bg-success">已配置</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="p-3">
                            <i class="bi bi-shield-check display-6 text-success"></i>
                            <h6 class="mt-2">HTTPS</h6>
                            <span class="badge bg-success">已启用</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 加载当前配置
        async function loadCurrentConfig() {
            try {
                const response = await fetch('data.json');
                const config = await response.json();
                
                document.getElementById('currentTitle').textContent = config.site.title;
                document.getElementById('currentDescription').textContent = config.site.description;
                document.getElementById('currentEmail').textContent = config.contact.email;
                document.getElementById('currentAndroid').textContent = config.downloads.android.url;
                document.getElementById('currentiOS').textContent = config.downloads.ios.url;
                document.getElementById('lastModified').textContent = new Date(config.lastModified).toLocaleString('zh-CN');
                
                // 预填充表单
                document.getElementById('newTitle').value = config.site.title;
                document.getElementById('newDescription').value = config.site.description;
                document.getElementById('newEmail').value = config.contact.email;
                document.getElementById('newAndroid').value = config.downloads.android.url;
                document.getElementById('newiOS').value = config.downloads.ios.url;
                
            } catch (error) {
                console.error('加载配置失败:', error);
                document.getElementById('currentConfig').innerHTML = 
                    '<div class="alert alert-danger">配置加载失败，请检查 data.json 文件</div>';
            }
        }

        // 生成 GitHub Actions 工作流 URL
        function generateWorkflowURL() {
            const title = encodeURIComponent(document.getElementById('newTitle').value);
            const description = encodeURIComponent(document.getElementById('newDescription').value);
            const android = encodeURIComponent(document.getElementById('newAndroid').value);
            const ios = encodeURIComponent(document.getElementById('newiOS').value);
            const email = encodeURIComponent(document.getElementById('newEmail').value);
            
            // 构建 GitHub Actions 工作流 URL（需要替换为实际的仓库地址）
            const repoURL = 'https://github.com/YOUR_USERNAME/YOUR_REPO'; // 需要替换
            const workflowURL = `${repoURL}/actions/workflows/update-config.yml`;
            
            // 构建带参数的 URL
            const params = new URLSearchParams({
                'site_title': document.getElementById('newTitle').value,
                'site_description': document.getElementById('newDescription').value,
                'android_url': document.getElementById('newAndroid').value,
                'ios_url': document.getElementById('newiOS').value,
                'contact_email': document.getElementById('newEmail').value
            });
            
            const fullURL = `${workflowURL}?${params.toString()}`;
            
            // 在新窗口打开
            window.open(workflowURL, '_blank');
            
            // 显示提示
            alert(`请在打开的 GitHub 页面中：\n1. 点击 "Run workflow" 按钮\n2. 填入以下参数：\n\n标题: ${document.getElementById('newTitle').value}\n描述: ${document.getElementById('newDescription').value}\n邮箱: ${document.getElementById('newEmail').value}`);
        }

        // 复制工作流 URL
        function copyWorkflowURL() {
            const url = document.getElementById('workflowURL').textContent;
            navigator.clipboard.writeText(url).then(() => {
                alert('工作流 URL 已复制到剪贴板');
            });
        }

        // 页面加载时获取配置
        document.addEventListener('DOMContentLoaded', loadCurrentConfig);

        // 每30秒刷新一次配置
        setInterval(loadCurrentConfig, 30000);
    </script>
</body>
</html>
